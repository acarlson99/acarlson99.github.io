<!-- generated by research/algorithm-x-with-overlapping-tiles.md -->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>algorithm-x-with-overlapping-tiles</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
<h1 id="algorithm-x-with-overlapping-tiles">Algorithm X With Overlapping Tiles</h1>
<p>Knuth’s <a href="https://en.wikipedia.org/wiki/Knuth&#39;s_Algorithm_X">Algorithm X</a> details a method to solve exact cover problems, but it cannot handle overlapping tiles.</p>
<p>A demo of a modified Algorithm X which handles overlapping pieces can be found at <a href="https://acarlson99.github.io/static/dlx/">https://acarlson99.github.io/static/dlx/</a> with its implementation here <a href="https://github.com/acarlson99/acarlson99.github.io/tree/master/static/dlx">https://github.com/acarlson99/acarlson99.github.io/tree/master/static/dlx</a></p>
<p>This is especially useful for extending AlgoX to operate on words which frequently have duplicate letters.</p>
<h2 id="original-algorithm-x">Original Algorithm X</h2>
<blockquote>
<p>From <a href="https://en.wikipedia.org/wiki/Knuth%27s_Algorithm_X#Example">https://en.wikipedia.org/wiki/Knuth’s_Algorithm_X#Example</a></p>
<ol type="1">
<li>If the matrix <em>A</em> has no columns, the current partial solution is a valid solution; terminate successfully.</li>
<li>Otherwise choose a column <em>c</em> (deterministically).</li>
<li>Choose a row <em>r</em> such that <em>A_r</em>,<em>c</em> = 1 (nondeterministically).</li>
<li>Include row <em>r</em> in the partial solution.</li>
<li>For each column <em>j</em> such that <em>A_r</em>,<em>j</em> = 1,
<ol type="1">
<li>for each row <em>i such that A_i,j</em> = 1
<ol type="1">
<li>delete row <em>i</em> from matrix <em>A.</em></li>
</ol></li>
<li>delete column <em>j</em> from matrix <em>A</em>.</li>
</ol></li>
<li>Repeat this algorithm recursively on the reduced matrix <em>A</em>.</li>
</ol>
</blockquote>
<figure>
<img src="/static/algo-x-example.png" alt="A classic Algorithm X example" /><figcaption>A classic Algorithm X example</figcaption>
</figure>
<p>A classic Algorithm X <a href="https://acarlson99.github.io/static/dlx/?x=WzEsMiwzLDQsNSw2LDdd&amp;y=eyJBIjpbMSw0LDddLCJCIjpbMSw0XSwiQyI6WzQsNSw3XSwiRCI6WzMsNSw2XSwiRSI6WzIsMyw2LDddLCJGIjpbMiw3XX0=&amp;ts=eyIxIjoxLCIyIjoxLCIzIjoxLCI0IjoxLCI1IjoxLCI2IjoxLCI3IjoxfQ==&amp;as=eyJBIjp7IjEiOjEsIjQiOjEsIjciOjF9LCJCIjp7IjEiOjEsIjQiOjF9LCJDIjp7IjQiOjEsIjUiOjEsIjciOjF9LCJEIjp7IjMiOjEsIjUiOjEsIjYiOjF9LCJFIjp7IjIiOjEsIjMiOjEsIjYiOjEsIjciOjF9LCJGIjp7IjIiOjEsIjciOjF9fQ==">example</a></p>
<p>A detailed breakdown of solving this matrix can be found by the curious at <a href="https://en.wikipedia.org/wiki/Knuth%27s_Algorithm_X#Example">https://en.wikipedia.org/wiki/Knuth’s_Algorithm_X#Example</a></p>
<p>However, this only solves an <strong>exact</strong> cover. If we want 2 tiles to occupy <code>COL 7</code> this cannot be solved by base Algorithm X.</p>
<p>This can be solved by introducing a count representing the number of tiles we want to cover each column. Additionally, with this change the algorithm can be expanded to handle numbers &gt; 1.</p>
<h2 id="modified-version">Modified version</h2>
<blockquote>
<p>New algorithm description with <em>Counts</em></p>
<ol type="1">
<li>If the matrix <em>A</em> has no columns, and <em>Counts</em> all no non-zero values the current partial solution is a valid solution; terminate successfully.</li>
<li>Otherwise choose a column <em>c</em> (deterministically).</li>
<li>Choose a row <em>r</em> such that <em>A_r</em>,<em>c</em> ≥ 1 (nondeterministically).</li>
<li>Include row <em>r</em> in the partial solution.</li>
<li>For each column <em>j</em> such that <em>A_r</em>,<em>j</em> ≥ 1,
<ol type="1">
<li>Reduce <em>Counts_j</em> by <em>A_r,j.</em></li>
<li>for each row <em>i such that A_i,j</em> &gt; <em>Counts_j</em>
<ol type="1">
<li>delete row <em>i</em> from matrix <em>A.</em></li>
</ol></li>
<li>delete column <em>j</em> from matrix <em>A</em>.</li>
</ol></li>
<li>Repeat this algorithm recursively on the reduced matrix <em>A</em>.</li>
</ol>
</blockquote>
<h2 id="example">Example</h2>
<p>Consider this example where we want to cover column 7 twice <code>Counts = { 1:1, 2:1, 3:1, 4:1, 5:1, 6:1, 7:2 }</code></p>
<table>
<thead>
<tr class="header">
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>B</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>C</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>D</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>E</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>F</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><strong>Level 0</strong></p>
<p>Step 1 - Non-empty matrix, we proceed.</p>
<p>Step 2 - Choose the column with the fewest 1s and is selected deterministically</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>B</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>C</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>D</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>E</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>F</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Step 3 - Rows A and B each have a 1 in column 1 and are selected nondeterministically</p>
<p><strong>Level 1: Select Row A</strong></p>
<p>Step 4 - Row A is included in the partial solution</p>
<p>Step 5 - Row A has 1 in columns 1, 4, and 7</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>B</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>C</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>D</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>E</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>F</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Column 1 has a 1 in rows <em>A</em> and <em>B</em>; column 4 has a 1 in rows <em>A</em>, <em>B</em>, and <em>C</em>; and column 7 has a 1 in rows <em>A</em>, <em>C</em>, <em>E</em>, and <em>F</em>. <code>[1,4,7].map(a =&gt; Counts[a] -= 1)</code> results in <code>Counts[1] = 0; Counts[4] = 0; Counts[7] = 1;</code></p>
<p>Thus, rows <em>A</em>, <em>B</em>, and <em>C</em> are to be removed and columns 1 and 4 are to be removed:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>B</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>C</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>D</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>E</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>F</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>The matrix now looks like this</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>2</th>
<th>3</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>E</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>F</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Step 1 - Matrix is non-empty— proceed</p>
<p>Step 2 - The lowest number of 1s in a column is 1</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>2</th>
<th>3</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>E</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>F</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Step 3 - Row D has a 1 in column 5 and is selected</p>
<p><strong>Level 2</strong></p>
<table>
<thead>
<tr class="header">
<th></th>
<th>2</th>
<th>3</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>E</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>F</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Step 4 - Row D is included in the partial solution</p>
<p>Step 5 - Row D has a 1 in columns 3, 5, and 6 which sets the corresponding values in <code>Counts</code> to 0.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>2</th>
<th>3</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>E</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>F</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Row F remains and columns 2 and 7 remain with <code>Counts = { 2:1, 7:1 }</code></p>
<table>
<thead>
<tr class="header">
<th></th>
<th>2</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>F</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>The continuation here is left as an exercise to the reader.</p>
<p>This results in a terminating solution of <code>[A,D,F]</code> before backtracking</p>
<p><strong>Level 1</strong></p>
<p>Step 4 - Select Row B, including it in the partial solution</p>
<p>Step 5 - Row B has a 1 in columns 1 and 4, reducing the corresponding values in <code>Counts</code> to 0.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>B</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>C</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>D</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>E</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>F</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Eliminate rows overlapping cols 1 and 4.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>B</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>C</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>D</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>E</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>F</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><code>Counts = { 2:1, 3:1, 5:1, 6:1, 7:2 }</code></p>
<table>
<thead>
<tr class="header">
<th></th>
<th>2</th>
<th>3</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>E</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>F</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Step 1 - non-empty, continue</p>
<p>Step 2 - The smallest number of 1s is 1, choose D</p>
<p><strong>Level 2</strong></p>
<table>
<thead>
<tr class="header">
<th></th>
<th>2</th>
<th>3</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>E</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>F</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th></th>
<th>2</th>
<th>3</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>E</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>F</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Here we will choose row F, see that <code>Counts[7] = 1</code>, and terminate unsuccessfully</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>2</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>F</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
</body>
</html>
